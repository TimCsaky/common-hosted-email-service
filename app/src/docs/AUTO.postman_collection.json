{
	"info": {
		"_postman_id": "a4e8e8c5-4667-4bc8-a0e5-0ec2c4fc0bb7",
		"name": "AUTO",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Common Hosted Email Service",
			"item": [
				{
					"name": "v1",
					"item": [
						{
							"name": "Health",
							"item": [
								{
									"name": "Request a Token",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "33a832ed-3f5a-4165-93db-62ecf4440208",
												"exec": [
													"var jsonData = JSON.parse(responseBody);\r",
													"var jwt = jsonData.access_token;\r",
													"\r",
													"pm.environment.set(\"token\", jwt);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "username",
													"value": "{{CMNSRV_CLIENTID}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{CMNSRV_CLIENTSECRET}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/x-www-form-urlencoded"
											}
										],
										"body": {
											"mode": "urlencoded",
											"urlencoded": [
												{
													"key": "grant_type",
													"value": "client_credentials",
													"type": "text"
												}
											]
										},
										"url": {
											"raw": "{{auth_token_endpoint}}",
											"host": [
												"{{auth_token_endpoint}}"
											]
										},
										"description": "This request will get an OAuth Access Token that is required for calls to the Common Services API's.\n\nThe reponse from this request (the Access Token) can be attached to the top level 'Common Services' collection and then 'Inherited from parent' by the requests contained inside it."
									},
									"response": []
								},
								{
									"name": "/health",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{host}}/api/v1/health",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"health"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Email",
							"item": [
								{
									"name": "/email",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "f612c6de-4bcf-4b5c-afee-58674b232e37",
												"exec": [
													"var jsonData = JSON.parse(responseBody);\r",
													"\r",
													"var msgId = jsonData.messages[0].msgId;\r",
													"pm.environment.set(\"msgId\", msgId);\r",
													"\r",
													"var txId = jsonData.txId;\r",
													"pm.environment.set(\"txId\", txId);\r",
													"\r",
													"console.log('msgId set:', msgId);\r",
													"console.log('txId set:', txId);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"attachments\": [\n    {\n      \"content\": \"PGI+SGVsbG8gV29ybGRcITwvYj4=\",\n      \"contentType\": \"string\",\n      \"encoding\": \"base64\",\n      \"filename\": \"testfile.txt\"\n    }\n  ],\n  \"bcc\": [],\n  \"bodyType\": \"html\",\n  \"body\": \"Hello World content\",\n  \"cc\": [],\n  \"delayTS\": 1600000000000,\n  \"encoding\": \"utf-8\",\n  \"from\": \"emeil.here@gov.bc.ca\",\n  \"priority\": \"normal\",\n  \"subject\": \"Hello user\",\n  \"to\": [\n    \"emailhere@someemail.com\"\n  ],\n  \"tag\": \"tag\"\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{host}}/api/v1/email",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"email"
											],
											"query": [
												{
													"key": "devMode",
													"value": "true",
													"disabled": true
												}
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "EmailMerge",
							"item": [
								{
									"name": "/emailMerge",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"attachments\": [\n        {\n            \"content\": \"PGI+SGVsbG8gV29ybGRcITwvYj4=\",\n            \"contentType\": \"string\",\n            \"encoding\": \"base64\",\n            \"filename\": \"testfile.txt\"\n        }\n    ],\n    \"bodyType\": \"text\",\n    \"body\": \"Hello World {{ hello }} content\",\n    \"contexts\": [\n    \t{\n    \t\t\"to\": [\n\t\t        \"email@someemail.com\"\n\t\t    ],\n\t\t    \"context\": {\n\t\t    \t\"orange\": {\n\t\t            \"target\": \"jujaga\"\n\t\t        },\n\t\t        \"hello\": \"jujaga template\"\n\t\t    },\n\t\t    \"delayTS\": 1600000000000,\n\t\t    \"tag\": \"tag\"\n    \t},\n    \t{\n    \t\t\"to\": [\n\t\t        \"gkf63839@aklqo.com\"\n\t\t    ],\n\t\t    \"context\": {\n\t\t    \t\"orange\": {\n\t\t            \"target\": \"lucasoneil\"\n\t\t        },\n\t\t        \"hello\": \"lucas template\"\n\t\t    },\n\t\t    \"delayTS\": 1600000000000,\n\t\t    \"tag\": \"tag\"\n    \t}\n    ],\n    \"encoding\": \"utf-8\",\n    \"from\": \"email.here@gov.bc.ca\",\n    \"priority\": \"normal\",\n    \"subject\": \"Test {{ orange.target }}\"\n}"
										},
										"url": {
											"raw": "{{host}}/api/v1/emailMerge",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"emailMerge"
											],
											"query": [
												{
													"key": "devMode",
													"value": "true",
													"disabled": true
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "/emailMerge/preview",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"attachments\": [\n        {\n            \"content\": \"PGI+SGVsbG8gV29ybGRcITwvYj4=\",\n            \"contentType\": \"string\",\n            \"encoding\": \"base64\",\n            \"filename\": \"testfile.txt\"\n        }\n    ],\n    \"bodyType\": \"text\",\n    \"body\": \"Hello World {{ hello }} content\",\n    \"contexts\": [\n    \t{\n    \t\t\"to\": [\n\t\t        \"email@someemail.com\"\n\t\t    ],\n\t\t    \"context\": {\n\t\t    \t\"orange\": {\n\t\t            \"target\": \"jujaga\"\n\t\t        },\n\t\t        \"hello\": \"jujaga template\"\n\t\t    }\n    \t},\n    \t{\n    \t\t\"to\": [\n\t\t        \"gkf63839@aklqo.com\"\n\t\t    ],\n\t\t    \"context\": {\n\t\t    \t\"orange\": {\n\t\t            \"target\": \"lucasoneil\"\n\t\t        },\n\t\t        \"hello\": \"lucas template\"\n\t\t    },\n\t\t    \"delayTS\": 1579965760073,\n\t\t    \"tag\": \"tag\"\n    \t}\n    ],\n    \"encoding\": \"utf-8\",\n    \"from\": \"some.email@gov.bc.ca\",\n    \"priority\": \"normal\",\n    \"subject\": \"Test {{ orange.target }}\"\n}"
										},
										"url": {
											"raw": "{{host}}/api/v1/emailMerge/preview",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"emailMerge",
												"preview"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Message",
							"item": [
								{
									"name": "/status",
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{host}}/api/v1/status?msgId={{msgId}}",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"status"
											],
											"query": [
												{
													"key": "msgId",
													"value": "{{msgId}}"
												},
												{
													"key": "status",
													"value": "completed",
													"disabled": true
												},
												{
													"key": "tag",
													"value": "tag",
													"disabled": true
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "/status/:msgId",
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{host}}/api/v1/status/:msgId",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"status",
												":msgId"
											],
											"variable": [
												{
													"key": "msgId",
													"value": "{{msgId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "/cancel",
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{host}}/api/v1/cancel?msgId={{msgId}}",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"cancel"
											],
											"query": [
												{
													"key": "msgId",
													"value": "{{msgId}}"
												},
												{
													"key": "status",
													"value": "completed",
													"disabled": true
												},
												{
													"key": "tag",
													"value": "tag",
													"disabled": true
												},
												{
													"key": "txId",
													"value": "{{txId}}",
													"disabled": true
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "/cancel/:msgId",
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{host}}/api/v1/cancel/:msgId",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"cancel",
												":msgId"
											],
											"variable": [
												{
													"key": "msgId",
													"value": "{{msgId}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "b0f908f4-5056-431e-a830-012e0546a444",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "27f8e38f-c0a8-4541-84a1-27c99af5da28",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"description": "This folder contains the API calls available for the Common Hosted Email Service (CHES).\nFor more documentation about this Common Service see: https://github.com/bcgov/common-hosted-email-service/blob/master/README.md",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "608cd91f-a36f-4d5a-9094-4602822f46ae",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "c29f528b-f2f6-407a-8d70-fe01ff9c69c4",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "c0c710fe-3d40-47a5-a924-e9058091bda9",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "743aad65-ee08-4bc4-8052-f08f2615a009",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}